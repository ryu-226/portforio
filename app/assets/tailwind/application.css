@import "tailwindcss";

@theme {
  --color-primary: #fc7a1e;
  --color-secondary: #606c38;
  --color-accent: #F88379;
  --color-X: #0F1419;
  --font-sans: "M PLUS Rounded 1c", ui-sans-serif, system-ui, sans-serif;
}

input[type="number"]::-webkit-outer-spin-button,
input[type="number"]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
input[type="number"] {
  appearance: textfield;
}

@layer utilities {
  .animate-fadein {
    animation: fadein 0.8s ease;
  }
  @keyframes fadein {
    0% { opacity: 0; transform: translateY(32px);}
    100% { opacity: 1; transform: none;}
  }

  .animate-fadein-modal {
    animation: fadein-modal 2s ease;
  }
  @keyframes fadein-modal {
    0% { opacity: 0; }
    100% { opacity: 1; }
  }

  @keyframes breath {
    0%, 100% { transform: scale(1); }
    50%      { transform: scale(1.05); }
  }
  .animate-breath {
    animation: breath 2s ease-in-out infinite;
  }

  /* 3. カードめくり */
  @keyframes flip {
    0%   { transform: perspective(400px) rotateY(0deg); }
    50%  { transform: perspective(400px) rotateY(180deg); }
    100% { transform: perspective(400px) rotateY(360deg); }
  }
  .animate-flip {
    animation: flip 0.8s ease-in-out forwards;
    transform-style: preserve-3d;
    will-change: transform;
  }
  .back-surface {
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform: rotateY(180deg);
  }
  #amount-card {
    transform-style: preserve-3d;
    position: relative;
  }
  .backface-hidden {
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
  }

  /* 4. 数字フェード＆カウントアップ */
  @keyframes fade-in-scale {
    from { opacity: 0; transform: scale(0.5); }
    to   { opacity: 1; transform: scale(1); }
  }
  .animate-fade-in-scale {
    animation: fade-in-scale 0.6s ease-out forwards;
  }

  /* 5. ポップバウンド */
  @keyframes pop {
    0%   { transform: scale(1); }
    30%  { transform: scale(1.2); }
    60%  { transform: scale(0.95); }
    100% { transform: scale(1); }
  }
  .animate-pop {
    animation: pop 0.6s ease-out forwards;
  }

  /* 6. パーティクル用小粒 */
  @keyframes confetti {
    0%   { opacity: 1; transform: translateY(0) rotate(0deg); }
    100% { opacity: 0; transform: translateY(200px) rotate(360deg); }
  }
  .confetti-piece {
    position: absolute;
    width: 6px; height: 6px;
    background: var(--color-accent);
    animation: confetti 1.5s ease-out forwards;
  }

  .line {
    stroke: var(--color-secondary);
    stroke-width: 8;
    stroke-linecap: round;
    transition: transform 0.4s ease, opacity 0.4s ease;
  }
  button[aria-expanded="true"] .line.top {
    transform: translateY(21px) rotate(45deg);
  }
  button[aria-expanded="true"] .line.middle {
    opacity: 0;
  }
  button[aria-expanded="true"] .line.bottom {
    transform: translateY(-21px) rotate(-45deg);
  }

  /* ===== 3Dカードの土台 ===== */
  .card-3d-wrapper { perspective: 900px; }          /* 親に奥行き */
  .card-3d { position: relative; transform-style: preserve-3d; will-change: transform; }
  .card-face { backface-visibility: hidden; -webkit-backface-visibility: hidden; }
  .card-front { position: relative; z-index: 2; }
  .card-back  {
    position: absolute; inset: 0; z-index: 1;
    transform: rotateY(180deg);                      /* 裏面は反転配置 */
    background-color: #e5e7eb;                       /* gray-200 */
    border: 1px solid #e5e7eb;
  }
  /* 透かしロゴ */
  .card-back::after {
    content: "";
    position: absolute; inset: 0;
    background: var(--wm) center / 160px no-repeat;
    opacity: .2; pointer-events: none;
  }

  @keyframes flip-reveal-front {
    0%   { transform: rotateY(180deg); }
    60%  { transform: rotateY(8deg);   }  /* ほんの少し行き過ぎて戻る“手触り” */
    100% { transform: rotateY(0deg);   }
  }

  /* 初期を裏向きにするクラス（JSが初期付与） */
  .start-back {
    transform: rotateY(180deg);
  }

  /* 表向きにめくる一回限りのアニメ（JSが可視時に付与） */
  .animate-flip-reveal-front {
    animation: flip-reveal-front 2.2s cubic-bezier(.2,.6,.2,1) forwards;
    will-change: transform;
  }

  /* 動きを減らす設定のユーザーには瞬時に表へ（アニメ無効化） */
  @media (prefers-reduced-motion: reduce) {
    .animate-flip-reveal-front {
      animation: none !important;
      transform: rotateY(0deg) !important;
    }
  }

  .card-3d,
  .card-face {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}
